<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
	template="/Templates/Plantilla.xhtml">

	<h:head>
		<title>Ver Clientes</title>
	</h:head>
	<body>
		<ui:define name="titulo">
			<div class="row">
				<div class="col-md-9">
					<h2>Chequeo de Vehiculos</h2>
				</div>
			</div>
		</ui:define>

		<ui:define name="contenido">

			<div class="row">
				<div class="col-md-2">
					<h:commandButton value="Agregar Servicio" class="btn btn-success"
						onclick="$('#modalAgregarServicio').modal('show');" />
				</div>

				<div class="col-md-2">
					<h:commandButton value="Cancelar Cotizacion" class="btn btn-danger"
						onclick="$('#modalCancelarCotizacion').modal('show');" />

					<div class="modal fade" id="modalCancelarCotizacion" tabindex="-1"
						aria-labelledby="exampleModalLabel" aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="exampleModalLabel">Cancelar
										Cotizacion</h5>
									<button type="button" class="close" data-dismiss="modal"
										aria-label="Close"></button>
								</div>
								<h:form id="formEliminar">
									<div class="modal-body">
										<h3>Diagnostico: #{Cotizacion.accionChequeo.diagnostico}</h3>
										<b>Desea cancelar todo?</b>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary"
											data-dismiss="modal">Cerrar</button>
										<h:commandButton action="#{Cotizacion.cancelarCotizacion()}"
											value="Aceptar" />
									</div>
								</h:form>
							</div>
						</div>
					</div>
				</div>

				<div class="col-md-2">
					<h3>Total: $#{Cotizacion.total}</h3>
				</div>
			</div>


			<h:form>
				<div class="modal fade" id="modalAgregarServicio" tabindex="-1"
					role="dialog" aria-labelledby="exampleModalLabel"
					aria-hidden="true">

					<div class="modal-dialog" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title">Agregar Servicio</h5>
								<button type="button" class="close" data-dismiss="modal"
									aria-label="Close">
									<span aria-hidden="true"></span>
								</button>
							</div>
							<div class="modal-body">

								<div class="row">
									<div class="col-md-6">
										<div class="form-group">
											<h:outputLabel value="Servicios" />
											<h:selectOneMenu class="form-control"
												value="#{Cotizacion.nombreServicio}">
												<f:selectItem itemLabel="Seleccionar Servicio" itemValue="" />
												<f:selectItems value="#{Cotizacion.servicio}" var="sr"
													itemLabel="#{sr.nombreServicio}"
													itemValue="#{sr.nombreServicio}" />
												<f:ajax event="change"
													listener="#{Cotizacion.mostrarRepuesto()}"
													render="repuesto" />
											</h:selectOneMenu>
										</div>
									</div>

									<div class="col-md-6">
										<div class="form-group">
											<h:outputLabel value="Canitdad de repuesto" />
											<h:inputText value="#{Cotizacion.detalleChequeo.cantidad}"
												a:placeholder="Cantidad" />
										</div>
									</div>

									<div class="col-md-12">
										<h:outputLabel value="Repuestos" />
										<div class="form-group">
											<h:selectOneMenu id="repuesto"
												value="#{Cotizacion.detalleChequeo.servicioRepuesto.idServicioRepuesto}">
												<f:selectItems value="#{Cotizacion.repuesto}" var="sr"
													itemLabel="#{sr.repuesto.nombre}"
													itemValue="#{sr.idServicioRepuesto}" />
											</h:selectOneMenu>

										</div>
									</div>
								</div>
							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-secondary"
									data-dismiss="modal">Close</button>
								<h:commandButton value="AÃ±adir" action="#{Cotizacion.agregar()}" />
							</div>
						</div>
					</div>
				</div>
			</h:form>


			<div class="row">
				<ui:repeat var="dc" value="#{Cotizacion.mostrarDetalleChequeo}">
					<div class="col-md-4">
						<div class="accordion mt-5" id="accordionCotizacion">
							<div class="card">
								<div class="card-header" id="headingCotizacion">
									<div class="row">
										<div class="col-md-10">
											<h2 class="mb-0">
												<ui:repeat var="s"
													value="#{Cotizacion.buscarServicioRepuesto}">
													<h:commandButton a:type="button"
														class="btn btn-link btn-block text-left"
														data-toggle="collapse" data-target="collapseCotizacion"
														aria-expanded="true" aria-controls="collapseCotizacion"
														value="#{s.servicio.nombreServicio}" />
												</ui:repeat>
											</h2>
										</div>
										<div class="col-md-2">
											<h:commandLink style="color:red; text-decoration:none;"
												class="fas fa-trash"
												onclick="$('#modalEliminar').modal('show');">
												<f:setPropertyActionListener value="#{dc}"
													target="#{Cotizacion.accionDetalleChequeo}" />
												<f:ajax execute="@this" render=":formEliminar" />
											</h:commandLink>

											<div class="modal fade" id="modalEliminar" tabindex="-1"
												aria-labelledby="exampleModalLabel" aria-hidden="true">
												<div class="modal-dialog">
													<div class="modal-content">
														<div class="modal-header">
															<h5 class="modal-title" id="exampleModalLabel">Eliminar</h5>
															<button type="button" class="close" data-dismiss="modal"
																aria-label="Close"></button>
														</div>
														<h:form id="formEliminar">
															<div class="modal-body">Desea eliminar a
																#{dc.idDetalleChequeo}</div>
															<div class="modal-footer">
																<button type="button" class="btn btn-secondary"
																	data-dismiss="modal">Close</button>
																<h:commandButton action="#{Cotizacion.eliminar()}"
																	value="Eliminar" />
															</div>
														</h:form>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div id="collapseCotizacion" class="collapse show"
									aria-labelledby="headingCotizacion"
									data-parent="#accordionCotizacion">
									<div class="card-body">
										<ui:repeat var="r"
											value="#{Cotizacion.buscarServicioRepuesto}">
											<b>Repuesto: #{r.repuesto.nombre}</b>
											<br />
										</ui:repeat>
										Cantidad de Repuesto: #{dc.cantidad}<br /> Precio:
										#{dc.servicioRepuesto.repuesto.precioVenta}<br /> Total por
										Repuestos: #{dc.precioUnitario}<br />
									</div>
								</div>
								<br />
							</div>

						</div>
					</div>
				</ui:repeat>
			</div>

		</ui:define>

	</body>
</ui:composition>
